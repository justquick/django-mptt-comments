    {% load markup %}
    {% load i18n %}
    {% load mptt_tags %}
    {% load mptt_comments_tags %}
    {% load comparison %}
 
    {% for comment, tree in comments|tree_info %}
    
    {% if not tree.new_level %}</div>{% endif %}
    
    <div class="comment" id="comment_{{comment.pk}}">
        
    <h3>{% trans "Commented by" %} {{ comment.name }} -
        {{ comment.submit_date|date:"l" }} {% trans "on" %}
        {{ comment.submit_date|date:"j F" }} {% trans "at" %}
        {{ comment.submit_date|date:"H:i" }}:
    </h3>
    
    <p>{{ comment.comment|markdown }}</p>
    
    <p>{{ comment|children_count }} {% trans "replies" %} | 
        <a class="comment_reply" href="{% url comment-reply comment.pk %}">
            {% trans "Reply to this comment" %}
        </a>
    </p>
   
   {% for level in tree.closed_levels %}
   
        {% if forloop.parentloop.last %}
            {# not the topmost tree, skip closing one level #}  
            {% if_greater forloop.counter0 0 %}</div>{% endif_greater %}
        {% else %}
            </div>
        {% endif %}
        
   {% endfor %}
   
   {% endfor %}   
